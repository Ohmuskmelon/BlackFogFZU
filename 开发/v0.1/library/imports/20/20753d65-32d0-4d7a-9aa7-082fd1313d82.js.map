{"version":3,"sources":["assets/scripts/bag/bagSetting.js"],"names":["TOOLS","window","cc","Class","Component","properties","gridLayout","Node","toolPrefab","Prefab","introduction","onLoad","find","toolsArray","Bag","toolMap","console","log","spawnTools","cellWidth","width","cellHeight","height","spacingX","spacingY","getComponent","Layout","cellSize","length","i","tool","instantiate","id","name","initInfo","push","addChild","childrenSet","children","active","bagBtn","parent","forEach","element","removeFromParent","BagBackground","update"],"mappings":"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","sourceRoot":"/","sourcesContent":["var TOOLS = window.TOOLS;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gridLayout: cc.Node,\n        toolPrefab: cc.Prefab,\n        introduction:cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        this.gridLayout = cc.find(\"Canvas/Main Camera/bag/bagBg/layout\");\n        this.toolPrefab = cc.find(\"Canvas/Main Camera/bag/tool\");\n        this.introduction = cc.find(\"Canvas/Main Camera/bag/intro\");\n        this.toolsArray = window.Bag;\n        this.toolMap = toolMap;\n        console.log(this.toolMap);\n    },\n\n    spawnTools() {\n        // 首先确定gridLayout的各个属性\n        let cellWidth = this.gridLayout.width * 0.105;\n        let cellHeight = this.gridLayout.height * 0.215;\n        let spacingX = this.gridLayout.width * 0.022;\n        let spacingY = this.gridLayout.height * 0.045;\n\n        this.gridLayout.getComponent(cc.Layout).cellSize.width = cellWidth;\n        this.gridLayout.getComponent(cc.Layout).cellSize.height = cellHeight;\n        this.gridLayout.getComponent(cc.Layout).spacingX = spacingX;\n        this.gridLayout.getComponent(cc.Layout).spacingY = spacingY;\n\n        // 根据TOOLS生成相应的道具\n\n        console.log(Bag);\n        console.log(\"Bag size:\" + Bag.length);\n\n        this.toolsArray = [];\n        for (let i = 0; i < window.Bag.length; i++) {\n            let tool = cc.instantiate(this.toolPrefab);\n            let id = this.toolMap[window.Bag[i].name];\n            tool.getComponent('bagTool').initInfo(window.TOOLS[id]);\n            this.toolsArray.push(tool);\n            this.gridLayout.addChild(tool);\n        }\n        let childrenSet = this.gridLayout.children;\n        for (i = 0; i < childrenSet.length; i++) {\n            childrenSet[i].active = true;\n        }\n    },\n\n    bagBtn() {\n        // 背包按钮\n        console.log(\"grid parent active: \" + this.gridLayout.parent.active);\n        if (this.gridLayout.parent.active) {\n            // 隐藏节点\n            this.gridLayout.parent.active = false;\n\n            // 删除所有道具(或者不删，只是隐藏，自己决定)\n            this.toolsArray.forEach(element => {\n                element.removeFromParent();\n            });\n            this.introduction.active = false;\n            \n        }\n        else {\n            // 显示节点\n            console.log(\"bagBg active\");\n            this.gridLayout.parent.active = true;\n\n            // 生成所有道具\n            this.spawnTools();\n        }\n        window.BagBackground = this.gridLayout.parent;\n    },\n    update() {\n\n    }\n});\n"]}