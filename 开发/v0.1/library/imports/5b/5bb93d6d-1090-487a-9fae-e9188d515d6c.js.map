{"version":3,"sources":["assets/scripts/controller/camera.js"],"names":["cc","Class","Component","properties","target","Node","map","start","mapWidth","find","width","canvasWidth","console","log","max_x","window","player","enterGame","cameraFollow","worldPos","convertToWorldSpaceAR","v2","nodePos","node","parent","convertToNodeSpaceAR","x","update","dt"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAGLC,UAAU,EAAE;IACRC,MAAM,EAACJ,EAAE,CAACK,IADF;IAERC,GAAG,EAACN,EAAE,CAACK;EAFC,CAHP;EASLE,KATK,mBASI;IACL,IAAIC,QAAQ,GAAGR,EAAE,CAACS,IAAH,CAAQ,gBAAR,EAA0BC,KAAzC;IACA,IAAIC,WAAW,GAAGX,EAAE,CAACS,IAAH,CAAQ,QAAR,EAAkBC,KAApC;IACAE,OAAO,CAACC,GAAR,CAAY,iBAAeF,WAA3B;IACAC,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBL,QAAvB;IACA,KAAKM,KAAL,GAAaN,QAAQ,GAAGG,WAAxB;;IACA,IAAGI,MAAM,CAACC,MAAP,CAAcC,SAAjB,EAA2B;MACvB,KAAKC,YAAL;IACH;EACJ,CAlBI;EAqBLA,YArBK,0BAqBS;IAEV,IAAG,CAAC,KAAKd,MAAT,EAAiB;MACbQ,OAAO,CAACC,GAAR,CAAY,aAAZ;MACA;IACH,CALS,CAMV;;;IACA,IAAIM,QAAQ,GAAG,KAAKf,MAAL,CAAYgB,qBAAZ,CAAkCpB,EAAE,CAACqB,EAAH,CAAM,CAAN,EAAQ,CAAR,CAAlC,CAAf,CAPU,CAOmD;;IAE7D,IAAIC,OAAO,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,oBAAjB,CAAsCN,QAAtC,CAAd,CATU,CASoD;;IAE9D,IAAGG,OAAO,CAACI,CAAR,IAAY,CAAZ,IAAgBJ,OAAO,CAACI,CAAR,IAAY,KAAKZ,KAApC,EAA0C;MACtC;IACH;;IACD,KAAKS,IAAL,CAAUG,CAAV,GAAcJ,OAAO,CAACI,CAAtB,CAdU,CAeV;IACA;EACH,CAtCI;EAwCLC,MAxCK,kBAwCGC,EAxCH,EAwCO;IACR,IAAG,KAAKxB,MAAL,IAAe,IAAlB,EAAuB;MACnBQ,OAAO,CAACC,GAAR,CAAY,oBAAZ;MACA;IACH;;IACD,KAAKK,YAAL;EACH;AA9CI,CAAT","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        target:cc.Node,\n        map:cc.Node,\n    },\n\n\n    start () {\n        var mapWidth = cc.find(\"Canvas/bg/maps\").width;\n        var canvasWidth = cc.find(\"Canvas\").width;\n        console.log(\"canvaswidth:\"+canvasWidth);\n        console.log('mapWidth',mapWidth);\n        this.max_x = mapWidth - canvasWidth;\n        if(window.player.enterGame){\n            this.cameraFollow();\n        }\n    },\n\n\n    cameraFollow(){\n\n        if(!this.target) {\n            console.log(\"null target\");\n            return;\n        }\n        // 实际上移动的东西是body\n        let worldPos = this.target.convertToWorldSpaceAR(cc.v2(0,0));//获取到player的世界坐标的位置\n      \n        let nodePos = this.node.parent.convertToNodeSpaceAR(worldPos);//获取到player的世界坐标的位置\n\n        if(nodePos.x <=0 ||nodePos.x >=this.max_x){\n            return;\n        }\n        this.node.x = nodePos.x;\n        // console.log(\"camera max:\"+this.max_x);\n        // console.log(\"camera perspective:\"+nodePos);\n    },\n\n    update (dt) {\n        if(this.target == null){\n            console.log(\"don't get the node\");\n            return;\n        }\n        this.cameraFollow();\n    },\n});\n"]}