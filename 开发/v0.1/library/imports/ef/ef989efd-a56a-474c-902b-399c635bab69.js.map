{"version":3,"sources":["assets/scripts/tool/tool.js"],"names":["cc","Class","Component","properties","tip","Node","onLoad","tt","playerNode","find","name","node","window","TOOLS","toolMap","inBag","active","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","start","ToolAction","p_pos","convertToWorldSpaceAR","v2","e_pos","dis","Vec2","distance","isIn","event","console","log","keyCode","macro","KEY","k","Bag","push","key","update","dt","onDestroy","off"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        tip:cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n\n    onLoad () {\n        this.tt = 0;\n        this.playerNode = cc.find(\"Canvas/bg/player\");\n        this.name = this.node.name;\n        if(window.TOOLS[window.toolMap[this.name]].inBag){\n            this.node.active = false;\n        }\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n    },\n\n    start () {\n    },\n\n    ToolAction(tt) {\n        let p_pos = this.playerNode.convertToWorldSpaceAR(cc.v2(0,0));\n        let e_pos =  this.node.convertToWorldSpaceAR(cc.v2(0,0));\n        let dis = cc.Vec2.distance(e_pos, p_pos);\n        if (dis <= 200) {\n            this.isIn = true;\n        } else {\n            this.isIn = false;\n        }\n    },\n\n    onKeyDown(event) {\n        if (this.isIn) {\n            console.log(this.node.name);\n            if (event.keyCode == cc.macro.KEY.k) {\n                if (!window.TOOLS[window.toolMap[this.name]].inBag){\n                    window.TOOLS[window.toolMap[this.name]].inBag = true;\n                    window.Bag.push(window.TOOLS[window.toolMap[this.name]]);\n                    for (var key in window.Bag){\n                        console.log(window.Bag[key].name);\n                    }\n                    this.node.active = false;\n                    this.tip.active = false;\n                    // Items.InArr[Items.CloseItem[this.name]] = 1;\n                }\n            }\n        }\n    },\n\n    update(dt) {\n        this.tt += dt;\n        if (this.tt >=0.3) {\n            this.ToolAction(this.tt);\n            this.tt = 0;\n            // console.log(window.Bag);\n        }\n    },\n \n    onDestroy() {\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n    }\n});\n"]}