{"version":3,"sources":["assets/scripts/selfdialog/selfdialog.js"],"names":["cc","Class","Component","properties","textLable","Label","init","currentScene","director","getScene","_name","nowText","textEnd","tt","textIndex","isShowed","node","getChildByName","getComponent","onLoad","setTextData","textData","string","window","selfDialog","name","canShow","Global","itemType","showContext","dt","console","log","length","slice","closeDialog","active","onDisable","start","update"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AAEAA,EAAE,CAACC,KAAH,CAAS;EACP,WAASD,EAAE,CAACE,SADL;EAGPC,UAAU,EAAE;IACVC,SAAS,EAAEJ,EAAE,CAACK;EADJ,CAHL;EAOP;EAEAC,IATO,kBASA;IACL,KAAKC,YAAL,GAAoBP,EAAE,CAACQ,QAAH,CAAYC,QAAZ,GAAuBC,KAA3C;IAEA,KAAKC,OAAL,GAAe,IAAf;IACA,KAAKC,OAAL,GAAe,IAAf;IACA,KAAKC,EAAL,GAAU,CAAV;IACA,KAAKC,SAAL,GAAiB,CAAC,CAAlB;IACA,KAAKC,QAAL,GAAgB,KAAhB;IACA,KAAKX,SAAL,GAAiB,KAAKY,IAAL,CACdC,cADc,CACC,WADD,EAEdC,YAFc,CAEDlB,EAAE,CAACK,KAFF,CAAjB;EAGD,CApBM;EAsBPc,MAtBO,oBAsBE;IACP,KAAKb,IAAL;EACD,CAxBM;EA0BPc,WA1BO,yBA0BO;IACZ,IAAI,CAAC,KAAKR,OAAV,EAAmB;IACnB,KAAKA,OAAL,GAAe,KAAf;IACA,KAAKD,OAAL,GAAeU,QAAf;IACA,KAAKjB,SAAL,CAAekB,MAAf,GAAwBC,MAAM,CAACC,UAAP,CAAkB,KAAKjB,YAAvB,EAAqC,KAAKS,IAAL,CAAUS,IAA/C,CAAxB;EACD,CA/BM;EAiCPC,OAjCO,qBAiCG;IACR,OAAOC,MAAM,CAACC,QAAP,IAAmB,GAA1B;EACD,CAnCM;EAqCPC,WArCO,uBAqCKC,EArCL,EAqCS;IACd,KAAKjB,EAAL,IAAWiB,EAAX;;IACA,IAAI,CAAC,KAAKf,QAAV,EAAoB;MAClBgB,OAAO,CAACC,GAAR,CAAY,UAAUL,MAAM,CAACC,QAA7B;MACA,KAAKR,WAAL;;MACA,IAAI,KAAKP,EAAL,IAAW,IAAf,EAAqB;QACnB,IAAI,KAAKT,SAAL,CAAekB,MAAf,CAAsBW,MAAtB,GAA+B,KAAKtB,OAAL,CAAasB,MAAhD,EAAwD;UACtD,KAAK7B,SAAL,CAAekB,MAAf,GAAwB,KAAKX,OAAL,CAAauB,KAAb,CAAmB,CAAnB,EAAqB,KAAK9B,SAAL,CAAekB,MAAf,CAAsBW,MAAtB,GAA+B,CAApD,CAAxB;QACD,CAFD,MAEO;UACL,KAAKrB,OAAL,GAAe,IAAf;UACA,KAAKG,QAAL,GAAgB,IAAhB;QACD;;QACD,KAAKF,EAAL,GAAU,CAAV;MACD;IACF;EACF,CApDM;EAsDPsB,WAtDO,yBAsDO;IACZ,KAAKnB,IAAL,CAAUoB,MAAV,GAAmB,KAAnB;EACD,CAxDM;EA0DPC,SA1DO,uBA0DK;IACV,KAAKjC,SAAL,CAAekB,MAAf,GAAwB,EAAxB;IACA,KAAKhB,IAAL;EACD,CA7DM;EA+DPgC,KA/DO,mBA+DC,CAAE,CA/DH;EAiEPC,MAjEO,kBAiEAT,EAjEA,EAiEI;IACT,KAAKD,WAAL,CAAiBC,EAAjB;EACD;AAnEM,CAAT","sourceRoot":"/","sourcesContent":["// let text = [\n//     { state: 'space', content: 'press SPACE to load another scene' },\n//     { state: 'j', content: 'press j to talk to the ghost' },\n//     { state: 'k', content: 'press k to take the tool' },\n// ]\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    textLable: cc.Label,\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  init() {\n    this.currentScene = cc.director.getScene()._name;\n\n    this.nowText = null;\n    this.textEnd = true;\n    this.tt = 0;\n    this.textIndex = -1;\n    this.isShowed = false;\n    this.textLable = this.node\n      .getChildByName(\"textLabel\")\n      .getComponent(cc.Label);\n  },\n\n  onLoad() {\n    this.init();\n  },\n\n  setTextData() {\n    if (!this.textEnd) return;\n    this.textEnd = false;\n    this.nowText = textData;\n    this.textLable.string = window.selfDialog[this.currentScene][this.node.name];\n  },\n\n  canShow() {\n    return Global.itemType != \" \";\n  },\n\n  showContext(dt) {\n    this.tt += dt;\n    if (!this.isShowed) {\n      console.log(\"type:\" + Global.itemType);\n      this.setTextData();\n      if (this.tt >= 0.05) {\n        if (this.textLable.string.length < this.nowText.length) {\n          this.textLable.string = this.nowText.slice(0,this.textLable.string.length + 1);\n        } else {\n          this.textEnd = true;\n          this.isShowed = true;\n        }\n        this.tt = 0;\n      }\n    }\n  },\n\n  closeDialog() {\n    this.node.active = false;\n  },\n\n  onDisable() {\n    this.textLable.string = \"\";\n    this.init();\n  },\n\n  start() {},\n\n  update(dt) {\n    this.showContext(dt);\n  },\n});\n"]}